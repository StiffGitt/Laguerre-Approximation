function S = GGQuad40(f,n)
% Projekt 2, zadanie 27
% Mikołaj Wałachowski, 320748
%
% Funkcja analogiczna do GGQuad korzystająca z 40-punktowej kwadratury
% Wejście:
%   f    - Uchwyt do funkcji f(x). Funkcja jest zdefiniowana wektorowo.
%   n    - Liczba całkowita wskazująca, który wielomian z bazy wielomianów
%        - Laguerre'a zostanie przyjęty jako g_n(x).
% Wyjście:
%   S    - Wartość całki przybliżonej zastosowaną kwadraturą.

% Wektory węzłów i współczynnków dla 40-punktowej kwadratury
% Gaussa-Laguerre'a
nodes = [3.5700394308888385122e-02
  1.8816228315869851600e-01
  4.6269428131457645356e-01
  8.5977296397293492226e-01
  1.3800108205273371865e+00
  2.0242091359228267334e+00
  2.7933693535068164577e+00
  3.6887026779082702096e+00
  4.7116411465549726936e+00
  5.8638508783437181143e+00
  7.1472479081022882507e+00
  8.5640170175861637627e+00
  1.0116634048451939407e+01
  1.1807892294004584843e+01
  1.3640933712537087228e+01
  1.5619285893339073837e+01
  1.7746905950095663043e+01
  2.0028232834574890530e+01
  2.2468249983498418351e+01
  2.5072560772426203794e+01
  2.7847480009168862721e+01
  3.0800145739445462701e+01
  3.3938657084913719609e+01
  3.7272245880476004328e+01
  4.0811492823886920466e+01
  4.4568603175334462707e+01
  4.8557763533059992281e+01
  5.2795611187216932969e+01
  5.7301863323393627495e+01
  6.2100179072775111612e+01
  6.7219370927126998799e+01
  7.2695158847612462118e+01
  7.8572802911571309281e+01
  8.4911231135704984543e+01
  9.1789874671236376992e+01
  9.9320808717446808250e+01
  1.0767244063938827252e+02
  1.1712230951269068881e+02
  1.2820184198825565119e+02
  1.4228004446915999789e+02];
coef = [8.8412106190342440940e-02
  1.7681473909572229560e-01
  2.1136311701596243103e-01
  1.9408119531860179966e-01
  1.4643428242412511441e-01
  9.3326798435770880507e-02
  5.0932204361044237026e-02
  2.3976193015684841840e-02
  9.7746252467144596189e-03
  3.4579399930184868613e-03
  1.0622468938968719350e-03
  2.8327168532432471583e-04
  6.5509405003246292798e-05
  1.3116069073267784125e-05
  2.2684528787793650545e-06
  3.3796264822006792108e-07
  4.3228213222820885689e-08
  4.7284937709907793279e-09
  4.4031741042328488129e-10
  3.4724414848038224856e-11
  2.3053815449168221616e-12
  1.2797725976766356072e-13
  5.8941771723511529447e-15
  2.2322175799045774184e-16
  6.8803364842843023409e-18
  1.7056037368180867485e-19
  3.3537119406661829355e-21
  5.1461995601366791408e-23
  6.0447625115876632890e-25
  5.3105847773213307528e-27
  3.3925280532805218961e-29
  1.5217354931814569975e-31
  4.5852916145026869176e-34
  8.7621586574862485610e-37
  9.8274157251479333061e-40
  5.8011520191697791085e-43
  1.5309086846066868536e-46
  1.3819863056493280997e-50
  2.5666336050123721838e-55
  2.7003609402170336406e-61];

% Znalezienie wartości danego wielomianu z bazy dla węzłów kwadratury
% przy pomocy algorytmu Clenshawa
L = zeros(n,1);
L(n) = 1;
g = Clenshaw(L,nodes);

% Wykonanie wzoru 40-punktowej kwadratury Gaussa-Laguerre'a
S = sum(coef.*f(nodes).*g);
end